// const { Telegraf } = require('telegraf')
// const bot = new Telegraf("1220579131:AAF4UaNPr67525T-Q2QsrDWQ-bCdmbb06h4") //—Å—é–¥–∞ –ø–æ–º–µ—â–∞–µ—Ç—Å—è —Ç–æ–∫–µ–Ω, –∫–æ—Ç–æ—Ä—ã–π –¥–∞–ª botFather
// bot.start((ctx) => ctx.reply('–ü—Ä–∏–≤–µ—Ç! –≠—Ç–æ—Ç –±–æ—Ç –¥–ª—è –æ–ø–ª–∞—Ç—ã –∫–∞–∫–æ–π-—Ç–æ —à–ª—è–ø—ã! –î–ª—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –∂–º–∏ –Ω–∞ /help')) //–æ—Ç–≤–µ—Ç –±–æ—Ç–∞ –Ω–∞ –∫–æ–º–∞–Ω–¥—É /start
// bot.help((ctx) => ctx.reply('–†–µ–∫–≤–∏–∑–∏—Ç—ã –¥–ª—è –æ–ø–ª–∞—Ç—ã')) //–æ—Ç–≤–µ—Ç –±–æ—Ç–∞ –Ω–∞ –∫–æ–º–∞–Ω–¥—É /help
// bot.on('text', (ctx) => ctx.reply('–Ø –≤—Å–µ–≥–æ –ª–∏—à—å –±–æ—Ç, –Ω–µ –ø–∏—à–∏ –º–Ω–µ(—á–∞–æ, –ø–µ—Ä—Å–∏–∫)')) //bot.on —ç—Ç–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–≤–µ–¥–µ–Ω–Ω–æ–≥–æ —é–∑–µ—Ä–æ–º —Å–æ–æ–±—â–µ–Ω–∏—è, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –æ–Ω –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Å—Ç–∏–∫–µ—Ä, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–µ–∫—Å—Ç–∞ –∏–ª–∏ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
// bot.hears('hi', (ctx) => ctx.reply('Hey there')) // bot.hears —ç—Ç–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞, –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —ç—Ç–æ - "hi"
// bot.launch() // –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞

const { Telegraf } = require('telegraf');
const covidApi = require('covid19-api');
const COUNTRIES_LIST = require('./const')
const bot = new Telegraf('1220579131:AAF4UaNPr67525T-Q2QsrDWQ-bCdmbb06h4')
bot.start( ctx => ctx.reply(`
–ü—Ä–∏–≤–µ—Ç, ${ctx.from.first_name}!
–¢—É—Ç –±—É–¥–µ—Ç –±–æ—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤ –∏ –≤—Å—è–∫–æ–≥–æ —Ä–∞–∑–Ω–æ–≥–æ, –Ω–æ –ø–æ–∫–∞ –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ —É–∑–Ω–∞–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ covid-19 –∏ –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–≤–∏–∑–∏—Ç—ã.
–í–≤–µ–¥–∏ —Å—Ç—Ä–∞–Ω—É –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ –∏ –ø–æ–ª—É—á–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É. –ü–æ–ª—É—á–∏—Ç—å –≤–µ—Å—å —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–∞–Ω –º–æ–∂–Ω–æ –ø–æ –∫–æ–º–∞–Ω–¥–µ /help. –û—Ç–ø—Ä–∞–≤—å —Å—Ç–∏–∫–µ—Ä –∏ –ø–æ–ª—É—á–∏—à—å —Ä–µ–∫–≤–∏–∑–∏—Ç—ã.
`))
bot.help( ctx => ctx.reply(COUNTRIES_LIST)) // —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ covid19-api
bot.on('sticker', (ctx) => ctx.reply(`
–†–µ—Å–ø–µ–∫—Ç —Ç–∞–∫–∏–º —Ä–µ–±—è—Ç–∞–ºüëç 
–ü–µ—Ä–µ–≤–æ–¥–∏ –Ω–∞ —Å–±–µ—Ä: 8-800-555-35-35 `))
bot.on('text', async (ctx) => {
   try {
       const userText = ctx.message.text
       const covidData = await covidApi.getReportsByCountries(userText)
       const countryData = covidData[0][0]
       const formatData = `
–°—Ç—Ä–∞–Ω–∞: ${countryData.country},
–°–ª—É—á–∞–∏: ${countryData.cases},
–°–º–µ—Ä—Ç–∏: ${countryData.deaths},
–í—ã–∑–¥–æ—Ä–æ–≤–µ–ª–æ: ${countryData.recovered}`
       ctx.reply(formatData)
   } catch(e) {
       ctx.reply('–¢–∞–∫–æ–π —Å—Ç—Ä–∞–Ω—ã –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Å—Ç—Ä–∞–Ω –∏—Å–ø–æ–ª—å–∑—É–π –∫–æ–º–∞–Ω–¥—É /help')
   }
})
bot.launch()